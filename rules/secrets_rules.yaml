rules:

  # =========================================================
  # Generic Passwords & Secrets
  # =========================================================
  - id: secret-hardcoded-password
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp, html]
    pattern-regex: "(password|passwd|pwd)\\s*[:=]\\s*['\"][^'\"]{4,}['\"]"
    message: "Hardcoded password detected in source code."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-hardcoded-secret
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "(secret|secret_key|private_key)\\s*[:=]\\s*['\"][^'\"]{8,}['\"]"
    message: "Hardcoded secret key detected."
    metadata:
      category: secrets
      cwe: CWE-798


  # =========================================================
  # API Keys & Tokens
  # =========================================================
  - id: secret-api-key-generic
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "(api[_-]?key|apikey|access[_-]?key)\\s*[:=]\\s*['\"][A-Za-z0-9-_]{16,}['\"]"
    message: "Hardcoded API key detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-auth-token
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "(auth|access|bearer)[_-]?token\\s*[:=]\\s*['\"][A-Za-z0-9\\-_.=]{16,}['\"]"
    message: "Hardcoded authentication token detected."
    metadata:
      category: secrets
      cwe: CWE-798


  # =========================================================
  # Cloud Provider Credentials
  # =========================================================
  - id: secret-aws-access-key
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "AKIA[0-9A-Z]{16}"
    message: "AWS Access Key ID detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-aws-secret-key
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "aws_secret_access_key\\s*[:=]\\s*['\"][A-Za-z0-9/+=]{40}['\"]"
    message: "AWS Secret Access Key detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-azure-connection-string
    severity: CRITICAL
    languages: [csharp, java, kotlin]
    pattern-regex: "DefaultEndpointsProtocol=.*;AccountKey=.*;"
    message: "Azure Storage connection string detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-gcp-api-key
    severity: CRITICAL
    languages: [python, javascript, typescript, java]
    pattern-regex: "AIza[0-9A-Za-z\\-_]{35}"
    message: "Google Cloud API key detected."
    metadata:
      category: secrets
      cwe: CWE-798


  # =========================================================
  # Database Credentials
  # =========================================================
  - id: secret-db-connection-string
    severity: CRITICAL
    languages: [python, java, kotlin, csharp]
    pattern-regex: "(jdbc|mongodb|mysql|postgresql)://[^\\s'\"]+:[^\\s'\"]+@"
    message: "Database connection string with credentials detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-db-password
    severity: CRITICAL
    languages: [python, java, kotlin, csharp]
    pattern-regex: "(db_password|database_password)\\s*[:=]\\s*['\"][^'\"]+['\"]"
    message: "Hardcoded database password detected."
    metadata:
      category: secrets
      cwe: CWE-798


  # =========================================================
  # Private Keys & Certificates
  # =========================================================
  - id: secret-private-key
    severity: CRITICAL
    languages: [generic]
    pattern-regex: "-----BEGIN (RSA|EC|DSA|OPENSSH) PRIVATE KEY-----"
    message: "Private cryptographic key detected."
    metadata:
      category: secrets
      cwe: CWE-321

  - id: secret-ssh-private-key
    severity: CRITICAL
    languages: [generic]
    pattern-regex: "ssh-rsa\\s+[A-Za-z0-9+/=]+"
    message: "SSH private key detected."
    metadata:
      category: secrets
      cwe: CWE-321


  # =========================================================
  # OAuth & JWT Secrets
  # =========================================================
  - id: secret-oauth-client-secret
    severity: CRITICAL
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "(client_secret|oauth_secret)\\s*[:=]\\s*['\"][^'\"]{8,}['\"]"
    message: "OAuth client secret detected."
    metadata:
      category: secrets
      cwe: CWE-798

  - id: secret-jwt-hardcoded
    severity: HIGH
    languages: [python, javascript, typescript, java, kotlin, csharp]
    pattern-regex: "eyJ[A-Za-z0-9_-]+\\.eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+"
    message: "Hardcoded JWT token detected."
    metadata:
      category: secrets
      cwe: CWE-798


  # =========================================================
  # HTML / Frontend Secrets
  # =========================================================
  - id: secret-html-hidden-sensitive
    severity: HIGH
    languages: [html]
    pattern-regex: "<input[^>]*type=[\"']hidden[\"'][^>]*(token|secret|apikey|password)"
    message: "Sensitive data stored in hidden HTML input field."
    metadata:
      category: secrets
      cwe: CWE-522


  # =========================================================
  # Configuration Files
  # =========================================================
  - id: secret-env-file
    severity: CRITICAL
    languages: [generic]
    pattern-regex: "(PASSWORD|SECRET|API_KEY|TOKEN)=.+"
    message: "Sensitive value found in configuration or environment file."
    metadata:
      category: secrets
      cwe: CWE-798
